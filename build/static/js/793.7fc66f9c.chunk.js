"use strict";(self.webpackChunkhologo_dash=self.webpackChunkhologo_dash||[]).push([[793],{4793:function(e,s,n){n.r(s),n.d(s,{default:function(){return A}});var t=n(2791),r=n(8550),a=n(4294),o=n(8096),c=n(4925),l=n(3786),i=n(9321),d=n(5104),u=n(3967),h=n(9836),x=n(3382),g=n(3994),p=n(9281),j=n(6890),Z=n(5855),m=n(5527),f=n(720),y=n(6603),w=n(9183);var v=n(5294).Z.create({baseURL:"/"}),C=n(7834);var S=()=>{const{setAuth:e}=(0,C.Z)();return async()=>{const s=await v.get("/refresh",{withCredentials:!0});return e((e=>(console.log(JSON.stringify(e)),console.log(s.data.accessToken),{...e,accessToken:s.data.accessToken}))),s.data.accessToken}};var k=()=>{const e=S(),{auth:s}=(0,C.Z)();return(0,t.useEffect)((()=>{const n=w.Z.interceptors.request.use((e=>(e.headers.Authorization||(e.headers.Authorization=`Bearer ${null===s||void 0===s?void 0:s.accessToken}`),e)),(e=>Promise.reject(e))),t=w.Z.interceptors.response.use((e=>e),(async s=>{var n;const t=null===s||void 0===s?void 0:s.config;if(403===(null===s||void 0===s||null===(n=s.response)||void 0===n?void 0:n.status)&&(null===t||void 0===t||!t.sent)){t.sent=!0;const s=await e();return t.headers.Authorization=`Bearer ${s}`,(0,w.Z)(t)}return Promise.reject(s)}));return()=>{w.Z.interceptors.request.eject(n),w.Z.interceptors.response.eject(t)}}),[s,e]),w.Z},I=n(2645);var D=n(5397),L=n(3400),b=n(8842),N=n(184);var E=()=>{const[e,s]=(0,t.useState)("asc"),[n,r]=(0,t.useState)(""),[a,o]=(0,t.useState)([]),{fetch:c,setFetch:l,errorMessage:i,setErrorMessage:d,showError:u,setShowError:w,showDeleteSuccess:v,setShowDeleteSuccess:C}=(0,I.O)(),{response:S,error:E}=(()=>{const e=k(),[s,n]=(0,t.useState)(null),[r,a]=(0,t.useState)(null),{fetch:o}=(0,I.O)();return(0,t.useEffect)((()=>{(async()=>{try{const s=await e.get("/api/lens");n(s)}catch(r){a(r)}})()}),[e,o]),{response:s,error:r}})(),{deleteLens:G}=(()=>{const e=k(),{fetch:s,setFetch:n}=(0,I.O)();return{deleteLens:async t=>{try{const r=await e.delete("/api/lens",{data:{lensID:t}});return n(s+1),r}catch(E){throw E}}}})();(0,t.useEffect)((()=>{S&&o(S.data)}),[S]),(0,t.useEffect)((()=>{E&&console.error("Error fetching Lenses:",E)}),[E]),(0,t.useEffect)((()=>{}),[c]);const q=(t,a)=>{s(n===a&&"asc"===e?"desc":"asc"),r(a)};return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(p.Z,{component:m.Z,children:(0,N.jsxs)(h.Z,{"aria-label":"Lenses table",children:[(0,N.jsx)(j.Z,{children:(0,N.jsxs)(Z.Z,{children:[(0,N.jsx)(g.Z,{children:(0,N.jsxs)(f.Z,{active:"lensCategory"===n,direction:"lensCategory"===n?e:"asc",onClick:e=>q(0,"lensCategory"),children:["Lens Category","lensCategory"===n?(0,N.jsx)("span",{style:{...y.Z},children:"desc"===e?"sorted descending":"sorted ascending"}):null]})}),(0,N.jsx)(g.Z,{children:(0,N.jsxs)(f.Z,{active:"lensName"===n,direction:"lensName"===n?e:"asc",onClick:e=>q(0,"lensName"),children:["Lens Name","lensName"===n?(0,N.jsx)("span",{style:{...y.Z},children:"desc"===e?"sorted descending":"sorted ascending"}):null]})}),(0,N.jsx)(g.Z,{children:(0,N.jsxs)(f.Z,{active:"lensGroupID"===n,direction:"lensGroupID"===n?e:"asc",onClick:e=>q(0,"lensGroupID"),children:["Lens Group ID","lensGroupID"===n?(0,N.jsx)("span",{style:{...y.Z},children:"desc"===e?"sorted descending":"sorted ascending"}):null]})}),(0,N.jsx)(g.Z,{children:" Lens Image "}),(0,N.jsx)(g.Z,{})]})}),(0,N.jsx)(x.Z,{children:0===a.length?(0,N.jsx)(Z.Z,{children:(0,N.jsx)(g.Z,{colSpan:4,align:"center",children:"No lenses to display"})}):a.map((e=>(0,N.jsxs)(Z.Z,{hover:!0,children:[(0,N.jsx)(g.Z,{children:e.lensCategory}),(0,N.jsx)(g.Z,{children:e.lensName}),(0,N.jsx)(g.Z,{children:e.lensGroupID}),(0,N.jsx)(g.Z,{children:e.lensImage&&(0,N.jsx)("img",{src:e.lensImage,alt:"Lens",style:{width:"200px",height:"auto"}})}),(0,N.jsx)(g.Z,{children:(0,N.jsx)(L.Z,{onClick:()=>(async e=>{try{const s=await G(e);console.log(s.status),200==s.status&&C(!0),l(c+1)}catch(E){d(E),w(!0),console.log(E)}})(e.lensID),children:(0,N.jsx)(D.Z,{})})})]},e.lensID)))})]})}),v&&(0,N.jsx)(b.Z,{message:"Lens deleted successfully.",severity:"success"}),u&&(0,N.jsx)(b.Z,{message:i,severity:"error"})]})},G=n(2739),q=n(3239);function B(){const[e,s]=t.useState(!1),{showBackdrop:n}=(0,I.O)();return(0,t.useEffect)((()=>{s(n),console.log("BackDrop notification triggered")}),[]),(0,N.jsx)("div",{children:(0,N.jsx)(G.Z,{sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+1},open:e,onClick:()=>{s(!1),console.log("BackDrop notification off")},children:(0,N.jsx)(q.Z,{color:"inherit"})})})}var A=()=>{const{createLens:e}=(()=>{const e=k();return{createLens:async s=>{try{return await e.post("/api/lens",s)}catch(n){throw n}}}})(),[s,n]=(0,t.useState)({lensCategory:"",lensName:"",lensGroupID:"",lensImage:""}),{fetch:h,setFetch:x,showBackdrop:g,setShowBackDrop:p,showError:j,setShowError:Z,showSuccess:m,setShowSuccess:f,errorMessage:y,setErrorMessage:w,setShowDeleteSuccess:v}=(0,I.O)(),C=e=>{n({...s,[e.target.name]:e.target.value})},S=(0,u.Z)();return(0,N.jsxs)(N.Fragment,{children:[g&&(0,N.jsx)(B,{}),(0,N.jsx)(d.Z,{title:"Add Lenses",children:(0,N.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{const n=await e(s);console.log(n.status),p(!0),201==n.status&&(f(!0),p(!1)),x(h+1)}catch(a){Z(!0),w(a.response.data),console.log(a.response.data)}n({lensCategory:"",lensName:"",lensGroupID:"",lensImage:""});const r=document.querySelector('input[type="file"]');r&&(r.value="")},style:{display:"flex",flexWrap:"wrap",gap:"1rem"},encType:"multipart/form-data",children:[(0,N.jsxs)(o.Z,{sx:{width:250,[S.breakpoints.down("sm")]:{width:"100%"}},children:[(0,N.jsx)(c.Z,{children:"Select Lens Category"}),(0,N.jsxs)(i.Z,{name:"lensCategory",label:"Select Lens Category",value:s.lensCategory,onChange:C,required:!0,children:[(0,N.jsx)(l.Z,{value:"",children:"Select Lens Category"}),(0,N.jsx)(l.Z,{value:"Humans",children:"Humans"}),(0,N.jsx)(l.Z,{value:"Plants",children:"Plants"})]})]}),(0,N.jsx)(o.Z,{sx:{width:250,[S.breakpoints.down("sm")]:{width:"100%"}},children:(0,N.jsx)(r.Z,{label:"Lens Name",name:"lensName",value:s.lensName,onChange:C,required:!0})}),(0,N.jsx)(o.Z,{sx:{width:250,[S.breakpoints.down("sm")]:{width:"100%"}},children:(0,N.jsx)(r.Z,{label:"Lens Group ID",name:"lensGroupID",value:s.lensGroupID,onChange:C,required:!0})}),(0,N.jsx)(o.Z,{sx:{width:250,[S.breakpoints.down("sm")]:{width:"100%"}},children:(0,N.jsx)("input",{type:"file",name:"lensImage",onChange:e=>{const t=e.target.files[0],r=new FileReader;r.onloadend=()=>{n({...s,lensImage:r.result})},r.readAsDataURL(t)},className:"custom-file-input",required:!0})}),(0,N.jsx)(a.Z,{type:"submit",variant:"contained",sx:{width:250,justifyContent:"center"},children:"Submit"})]})}),(0,N.jsx)("div",{className:"m-top"}),(0,N.jsx)(d.Z,{title:"Lenses",children:(0,N.jsx)(E,{})}),m&&(0,N.jsx)(b.Z,{message:"Lens added successfully.",severity:"success"}),j&&(0,N.jsx)(b.Z,{message:y,severity:"error"})]})}}}]);
//# sourceMappingURL=793.7fc66f9c.chunk.js.map